### ✍️ Tangxt ⏳ 2020-12-19 🏷️ 开发准备

# 02-小程序开发准备

## ★04 开发环境准备：屠龙勇者得有把好武器

> 没有智慧的头脑，就像没有蜡烛的灯笼。——托尔斯泰

1）微信小程序官方提供的免费资源

微信小程序官方开发文档（免费的）、微信开发者工具（免费的）、微信云开发（还是免费的）等

我们**不需要自己购买域名、购买服务器、域名网站备案**，也不需要因为自己没有公司实体，不得不去到处寻找反向代理的实现方法

据了解：**复杂的开发前置准备工作**，会搞晕 80% 的新人，几乎 100% 的初学者都无法完成这一系列及其复杂的操作

2）小程序开发环境组成

整个专栏的所有内容，**只需要“微信开发者工具”这一个 IDE 就可以完整实践**，并开发出你自己的小程序应用。

小程序开发环境具体来说分为三块：

* 小程序手机端应用，使用“**微信开发者工具**”的基础能力进行开发；
* 小程序服务器端应用，使用微信平台提供的“**微信云开发**”能力进行开发，它的开发环境也集成在了“微信开发者工具”中。使用“微信云开发”不需要自己搭建域名、应用服务器，也不需要自己搭建数据库服务器和图片服务器；
* 小程序开发手册，使用微信官方的“小程序开发文档”。它相当于我们学习英语时的牛津字典，有最权威、最全面的小程序开发说明。**碰到任何问题请不要度娘，请到这本“字典”中找答案**。 否则被各种搜索结果坑了，后果请自负哟。

3）特别提示

1. **学会如何在几十万字的文档中找到自己需要的内容（这就是使用微信官方“小程序开发文档”的方法）**，而不是把官方已经很完善的内容再用自己语言翻译一遍，毕竟这非常没有价值，也没有任何生产效率
2. 在本专栏中，提及到微信官方文档内容的部分，都会给出文档内容的具体位置。此时，**请暂时停止阅读本专栏内容，转而阅读微信官方文档的内容，阅读完之后再回到本专栏继续阅读**

4）小程序开发文档

💡：如何找到小程序开发文档？

有两种进入方式：

入口网址：[微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)

![入口网址](assets/img/2020-12-19-18-35-30.png)

> 里面包括了非常丰富的小程序开发、设计、运营等内容，没事多去逛逛总没错的。在社区中可以提自己碰到的各种开发问题，说不定就有热心人来帮你解决问题。右上角还提供了搜索功能，碰到问题可以尝试搜索寻找相关内容。

入口位置：[微信公众平台](https://mp.weixin.qq.com/)

![入口位置](assets/img/2020-12-19-18-34-08.png)

5）微信开发者工具

💡：如何下载这个工具？

其下载地址有两种进入方式：

入口网址：[稳定版 Stable Build - 微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)

入口位置：打开 [微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/framework/)，点几下：

![开发工具下载](assets/img/2020-12-19-18-41-11.png)

请**下载并安装稳定版**。

在下载页面左侧的“界面”和“设置”等菜单中有微信开发者工具的详细使用说明文档，请仔细阅读。

6）云开发账号注册

小程序的云开发功能可以让我们在没有自己的域名、服务器、数据库等基础硬件环境时也可以开发一个完整的小程序服务器端应用。

使用云开发功能，我们必须要注册一个小程序账号，以下为小程序账号的注册方法。

1. 打开 [微信公众平台首页](https://mp.weixin.qq.com/)，点击右上角的立即注册按钮
2. 在注册账号类型中选择小程序
3. 使用邮箱注册账号，并填写一些基本信息。具体的注册操作在“小程序开发文档”中也有一篇“小程序接入指南”进行专门的详细讲解
4. 注册主体信息请选择个人，以确保你能完成账号注册。

“小程序接入指南”的入口位置如下：

- 入口网址：[产品定位及功能介绍 - 微信开放文档](https://developers.weixin.qq.com/miniprogram/introduction/)，如果该网址 GG 了，请用「入口位置」姿势
- 入口位置：打开小程序开发文档首页 -> 选择「介绍菜单」，会看到一个「小程序接入指南」的绿色按钮

7）下节预告

分析“微信开发者工具”自带的 Demo 程序，搞清楚小程序的源代码结构。

8）实践环节

本节实操内容：

- 打开微信开发者工具，按照微信开发者工具下载页面左侧的使用说明书，逐一熟悉工具的各项**基本功能**。
- 阅读"云开发"的“**基础**”章节的内容，了解云开发的基本概念与能力。

小程序「云开发」的基础章节的入口网址：[微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html)

![云开发入口网址](assets/img/2020-12-19-18-56-33.png)

把“微信小程序开发文档”的各个板块都打开看一遍，**了解其中包含了哪些丰富的内容**。

建议学有余力的同学阅读“微信小程序设计指南”，了解微信官方对**小程序界面美与丑的定义**，避免自己造出一个长得像“恐龙”小程序。

微信小程序设计指南入口位置：[微信小程序设计指南 - 微信开放文档](https://developers.weixin.qq.com/miniprogram/design/)

![设计入口网址](assets/img/2020-12-19-18-59-25.png)

## ★05 源代码：了解构造才能下刀如有神

> 才能一旦让懒惰支配，它就一无可为。——克雷洛夫

目标：使用微信开发者工具，搞清楚小程序的源代码结构

如何理解小程序编程语言？

![概述](assets/img/2020-12-20-00-04-21.png)

一个页面的「分类」构成：

![页面构成](assets/img/2020-12-20-00-05-54.png)

因此，我们学习小程序编程语言，也可以像学习中文、英文一样，先理解语言的语法结构（即“分类”），**把握整体**往往可以用最快的速度入门。

1）小程序代码构成

- 入口网址：[小程序代码构成 - 微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/framework/quickstart/code.html)
- 入口位置：小程序开发文档首页 -> 开发 -> 指南 -> 起步 -> 小程序代码构成

![小程序代码构成](assets/img/2020-12-20-00-13-34.png)

2）理解小程序源代码结构

按照“小程序开发文档”中“你的第一个小程序”所讲的操作方法，创建我们的第一个小程序项目，这个小程序项目中**已经包含了一个基本的 Demo**。这个 Demo 的代码结构如下所示：

![小程序源代码结构](assets/img/2020-12-20-00-15-26.png)

现在的小程序源代码结构：

![现在的源代码结构](assets/img/2020-12-20-00-31-14.png)

如果你已经阅读完“小程序开发文档”中“小程序代码构成”的整个章节，然后再对照小程序 Demo 项目结构，显然，我们可以得出一个结论，小程序只有 4 种基本的代码类型：

![小程序代码类型](assets/img/2020-12-20-00-16-53.png)

1、运用“分类拆解法”理清小程序源代码结构

在阅读完官方文档后，我想你一定有一种似懂非懂的感觉。接下来，我们就使用“**分类拆解法**”的思路来进一步理清小程序的代码结构

一个小程序是由**多个页面**组成，每个页面又由**界面、数据和事件**组成。界面是在 WXSS 页面样式和 WXML 页面模板中定义的，数据是在 JS 脚本的 data 中定义的，而事件则是在 JS 脚本的事件函数中定义的，如下图所示：

![小程序的分类组成](assets/img/2020-12-20-00-23-15.png)

具体用一个例子来理解“分类”与“代码类型”的关系。

在已经创建的小程序项目中添加一个页面 `test`：

![新建页面 test](assets/img/2020-12-20-00-34-03.png)

> 在 `app.json` 中配置小程序的默认显示页面是 `test` -> 第一个元素

在 `test.wxml` 中添加一个静态界面元素：

``` html
<view>我是静态界面元素</view>
```

添加一个交互界面元素，**交互界面元素与数据的绑定在小程序中的语法为"🟡🟡数据名称🟡🟡"**，因此我们需要添加以下代码：

``` html
<view>🟡🟡content🟡🟡</view>
```

再添加一个接收用户点击事件的按钮，**界面元素与事件函数绑定在小程序中的语法为“ bindtap='事件函数名称' ”**，因此我们需要添加以下代码：

``` html
<button bindtap='clickEvent' >点我触发事件</button>
```

接下来我们在 `test.js` 中定义数据：

``` js
{
  /**
  * 页面的初始数据
  */
  data: {
    content: "我是交互界面元素"
  }
}
```

最后我们在 `test.js` 中定义用户点击按钮的事件函数：

``` js
{
  /**
  * 点我触发事件 button 的事件函数
  */
  clickEvent: function (options) {
    this.setData({
      content: "当用户点击按钮后，事件改变数据，数据改变交互界面元素的显示内容"
    })
  }
}
```

**在小程序的事件函数中改变数据的值的语法为：**

``` js
this.setData({
    数据名称:新的数据值
})
```

完整代码如下：

`app.json`：

``` json
{
  "pages":[
    "pages/test/test",
    "pages/index/index",
    "pages/logs/logs"
  ],
  "window":{
    "backgroundTextStyle":"light",
    "navigationBarBackgroundColor": "#fff",
    "navigationBarTitleText": "Weixin",
    "navigationBarTextStyle":"black"
  },
  "style": "v2",
  "sitemapLocation": "sitemap.json"
}
```

`test.wxml`：

``` html
<!--pages/test/test.wxml-->
<view>我是静态界面元素</view>
<view>🟡🟡content🟡🟡</view>
<button bindtap='clickEvent' >点我触发事件</button>
```

`test.js`：

``` js
// pages/test/test.js
Page({
  /**
   * 页面的初始数据
   */
  data: {
    content: "我是交互界面元素"
  },
  /**
    * 点我触发事件 button 的事件函数
    */
  clickEvent: function (options) {
    this.setData({
      content: "当用户点击按钮后，事件改变数据，数据改变交互界面元素的显示内容"
    })
  },
})
```

`test` 页面运行效果：

![test 页面的运行效果](assets/img/2020-12-20-00-48-06.png)

至此，我们已经明白小程序编程是怎么一回事了

小程序编程其实很简单，我们只需要记住以下几个规则：

* 静态界面元素我们直接写在 **WXML** 页面模板中即可；
* 交互界面元素中会变动的部分我们用" `🟡🟡数据名称🟡🟡` "的形式在 WXML 页面模板中定义，并在 JS 脚本的 `data` 中写上**数据名称的初始值**；
* 界面中要响应用户动作的元素，我们用“ `bindtap='事件函数名称'` ”的形式在 WXML 页面模板中定义，并在 JS 脚本中编写事件函数**要改变什么数据的值**；
* 当我们编写的小程序代码在执行时，**小程序的基础框架**会**自动**将数据的值显示在页面上。
* 当用户点击我们定义了事件函数的界面元素，**小程序**会**自动**执行事件函数，事件函数的运行会改变数据的值，小程序的基础框架会自动将新的数据值显示在页面上。

> 小程序相当于是浏览器……小程序的基础框架相当于是 Vue

对照这几个规则，回顾一下刚才我们编写的 `test` 页面代码，相信你已经知道小程序该怎么编程了

2、JSON 页面配置与全局配置

JSON 页面配置以及全局配置 `app.json` 的语法相对简单固定，**在实际开发中许多页面也并不需要进行配置**，具体的配置参数，请阅读“小程序开发文档”中“小程序配置”章节即可。

- 小程序配置文档入口位置：小程序开发文档首页 -> 开发 -> 框架 -> 小程序配置
- 小程序配置文档入口网址：[全局配置 - 微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html)

![小程序配置文档](assets/img/2020-12-20-01-00-21.png)

3、小程序启动逻辑 app.js

有关启动逻辑 `app.js` 的内容，请阅读“小程序开发文档”中“注册小程序”章节

小程序启动逻辑文档位置：

![小程序启动逻辑](assets/img/2020-12-20-01-02-46.png)

其入口网址：[注册小程序 - 微信开放文档](https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html)

4、全局样式 app.wxss

全局样式 `app.wxss` 的作用是**减少 CSS 样式的代码量**。如果我们要在多个页面都使用相同的 CSS 样式，只需要在 `app.wxss` 中定义一次，不需要复制粘贴到每个页面的 `page.wxss` 中。

3）下节预告

讨论如何将“分类拆解法”整体运用在小程序开发中

4）实践环节

本节实操内容：

- 阅读本节中列出的“小程序开发文档”相关内容，理解小程序项目创建后自带 Demo 的每一行代码的具体作用。

## ★06 解剖分类拆解法详解

